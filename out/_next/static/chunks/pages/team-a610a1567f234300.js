(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[38],{2115:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/team",function(){return r(9642)}])},2574:function(e,t,r){"use strict";var n;r.d(t,{X:function(){return n}}),function(e){e.DEFUALT="Please try again. If the error persists, contact us at xxx@gmail.com",e.ONE_EMAIL_ONLY="Your email address is linked with another provider, please login with that provider. If the error persists, please contact us at xxx@gmail.com"}(n||(n={}))},965:function(e,t,r){"use strict";var n=r(5893),s=r(8527),a=r(9609);r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){i(e,t,r[t])}))}return e}t.Z=function(e){return(0,n.jsx)(s.M5,{children:(0,n.jsx)(a.$,o({},e))})}},31:function(e,t,r){"use strict";var n=r(4051),s=r.n(n),a=r(5893),i=r(9876),o=r(5074),u=r(8527),c=r(5193),l=r(6541),m=r(385),f=r(5434),d=r(8100),h=r(2574);function p(e,t,r,n,s,a,i){try{var o=e[a](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,s)}t.Z=function(e){var t=e.user,r=e.request,n=(0,o.pm)(),x=(0,d.kY)().mutate,v=function(){var e,t=(e=s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=3;break}return n({status:"error",title:"Invalid delete reqeust",isClosable:!0}),e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch("/api/team-requests/"+r.id,{method:"DELETE"});case 6:return e.next=8,x("/api/users/team");case 8:n({status:"success",title:"Successfully removed team request",isClosable:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),n({status:"error",title:"Error deleting team request",description:h.X.DEFUALT,isClosable:!0});case 14:case"end":return e.stop()}}),e,null,[[3,11]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){p(a,n,s,i,o,"next",e)}function o(e){p(a,n,s,i,o,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();if(r){if(r.approved===m.Response.ACCEPTED)return null;var b=void 0,j="gray.500";switch(r.approved){case"NOT_RESPONDED":b=f.FmG;break;case"REJECTED":b=f.lUB,j="red.500"}return(0,a.jsxs)(u.HC,{children:[(0,a.jsx)(u.DE,{as:b,color:j,height:"22px"}),t.name," (",t.email,")",(0,a.jsx)(c.hU,{ml:3,"aria-label":"Cancel team request",icon:(0,a.jsx)(i.Tw,{}),bg:"transparent",_hover:{bg:"gray.600"},onClick:v})]},t.email)}return(0,a.jsx)(l.u,{label:t.name+" has earned "+t.points+" points",placement:"auto-start",children:(0,a.jsxs)(u.HC,{width:"auto",children:[(0,a.jsx)(u.DE,{as:f.ZSR,color:"green.500",height:"22px"}),t.name," (",t.email,")"]},t.email)})}},9642:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Z}});var n=r(5893),s=r(8527),a=r(3299),i=r(1163),o=r(7294),u=r(6541),c=r(894),l=r(5434),m=r(8100),f=r(965),d=r(4051),h=r.n(d),p=r(7375),x=r(5074),v=r(5193),b=r(6658),j=r(4612);function y(e,t,r,n,s,a,i){try{var o=e[a](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,s)}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){g(e,t,r[t])}))}return e}function O(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var C=function(e){var t=e.teamId,r=O(e,["teamId"]),s=(0,p.qY)(),a=s.isOpen,i=s.onOpen,u=s.onClose,c=(0,m.kY)().mutate,l=(0,o.useRef)(null),f=(0,x.pm)(),d=function(){var e,r=(e=h().mark((function e(r){var n,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),l.current&&l.current.value){e.next=4;break}return f({status:"error",title:"Please enter a valid email",isClosable:!0}),e.abrupt("return");case 4:return e.prev=4,e.next=7,fetch("/api/team-requests",{method:"POST",body:JSON.stringify({teamId:t,email:l.current.value})});case 7:return n=e.sent,e.next=10,n.json();case 10:if(s=e.sent,n.ok){e.next=13;break}throw new Error(s.error.message);case 13:return e.next=15,c("/api/users/team");case 15:f({status:"success",title:"Successfully sent team request",isClosable:!0}),u(),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),a=e.t0,(null!=(i=Error)&&"undefined"!==typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](a):a instanceof i)?f({status:"error",title:"Error sending request",description:e.t0.message,isClosable:!0}):f({status:"error",title:"Error sending request",isClosable:!0});case 22:case"end":return e.stop()}var a,i}),e,null,[[4,19]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){y(a,n,s,i,o,"next",e)}function o(e){y(a,n,s,i,o,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.zx,w({variant:"theme",onClick:i},r,{children:"Send invite"})),(0,n.jsxs)(b.u_,{isOpen:a,onClose:u,children:[(0,n.jsx)(b.ZA,{}),(0,n.jsxs)(b.hz,{bg:"theme.300",children:[(0,n.jsx)(b.xB,{children:"Send a team invite"}),(0,n.jsx)(b.ol,{}),(0,n.jsxs)("form",{onSubmit:d,children:[(0,n.jsx)(b.fe,{children:(0,n.jsx)(j.II,{ref:l,type:"email",placeholder:"Enter a valid email"})}),(0,n.jsxs)(b.mz,{children:[(0,n.jsx)(v.zx,{variant:"theme",onClick:u,mr:3,children:"Close"}),(0,n.jsx)(v.zx,{variant:"theme",type:"submit",children:"Submit"})]})]})]})]})]})},E=r(2574);function k(e,t,r,n,s,a,i){try{var o=e[a](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,s)}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var q=function(e){var t=e.teamId,r=S(e,["teamId"]),s=(0,m.kY)().mutate,a=(0,x.pm)(),i=function(){var e,r=(e=h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/teams/"+t+"/leave",{method:"PATCH"});case 3:return e.next=5,s("/api/users/team");case 5:a({status:"success",title:"Team successfully created",isClosable:!0}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a({status:"error",title:"Error leaving team",description:E.X.DEFUALT,isClosable:!0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){k(a,n,s,i,o,"next",e)}function o(e){k(a,n,s,i,o,"throw",e)}i(void 0)}))});return function(){return r.apply(this,arguments)}}();return(0,n.jsx)(v.zx,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){P(e,t,r[t])}))}return e}({variant:"theme",onClick:i},r,{children:"Leave team"}))},T=r(9876),I=r(385);function D(e,t,r,n,s,a,i){try{var o=e[a](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,s)}var _=function(){var e=(0,m.ZP)("/api/users/team-requests"),t=e.isValidating,r=e.data,a=e.mutate,i=(0,m.kY)().mutate,o=(0,x.pm)();if(t)return(0,n.jsx)(f.Z,{});if(!r||0===r.length)return(0,n.jsx)(s.xv,{children:"No pending requests."});var u=function(){var e,t=(e=h().mark((function e(t,r,n){var s,u,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="/api/team-requests/"+t+"?"+new URLSearchParams({accept:String(n)}),e.prev=1,e.next=4,fetch(s,{method:"PATCH"});case 4:return u=e.sent,e.next=7,u.json();case 7:if(c=e.sent,u.ok){e.next=10;break}throw new Error(c.error.message);case 10:return e.next=12,a();case 12:return e.next=14,i("/api/users/team");case 14:n===I.Response.ACCEPTED?o({status:"success",title:"Successfully joined "+r,isClosable:!0}):o({status:"success",title:"Successfully rejected "+r,isClosable:!0}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),l=e.t0,(null!=(m=Error)&&"undefined"!==typeof Symbol&&m[Symbol.hasInstance]?m[Symbol.hasInstance](l):l instanceof m)?o({status:"error",title:"Error responding to team request",description:e.t0.message,isClosable:!0}):o({status:"error",title:"Error responding to team request",description:E.X.DEFUALT,isClosable:!0});case 20:case"end":return e.stop()}var l,m}),e,null,[[1,17]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){D(a,n,s,i,o,"next",e)}function o(e){D(a,n,s,i,o,"throw",e)}i(void 0)}))});return function(e,r,n){return t.apply(this,arguments)}}();return(0,n.jsx)(s.aV,{spacing:3,children:r.map((function(e){return(0,n.jsxs)(s.HC,{children:[(0,n.jsx)(v.hU,{"aria-label":"Accept team request",icon:(0,n.jsx)(T.nQ,{}),bg:"transparent",_hover:{bg:"gray.600"},onClick:function(){return u(e.id,e.team.name,I.Response.ACCEPTED)}}),(0,n.jsx)(v.hU,{ml:3,"aria-label":"Cancel team request",icon:(0,n.jsx)(T.Tw,{}),bg:"transparent",_hover:{bg:"gray.600"},mr:3,onClick:function(){return u(e.id,e.team.name,I.Response.REJECTED)}}),"Team",(0,n.jsxs)(s.xv,{as:"span",fontWeight:"bold",color:"blue.100",children:[" ",e.team.name," "]}),"by",(0,n.jsxs)(s.xv,{as:"span",fontWeight:"bold",color:"blue.100",children:[" ",e.requestor.name," (",e.requestor.email,")"]})]},e.id)}))})};function z(e,t,r,n,s,a,i){try{var o=e[a](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,s)}var R=function(e){e=null!==e?e:function(e){throw e}(new TypeError("Cannot destructure undefined"));var t=(0,p.qY)(),r=t.isOpen,a=t.onOpen,i=t.onClose,u=(0,m.kY)().mutate,c=(0,o.useRef)(null),l=(0,x.pm)(),f=function(){var e,t=(e=h().mark((function e(t){var r,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c.current&&c.current.value){e.next=4;break}return l({status:"error",title:"Please enter a valid name",isClosable:!0}),e.abrupt("return");case 4:return e.prev=4,e.next=7,fetch("/api/teams",{method:"POST",body:JSON.stringify({name:c.current.value}),headers:{"Content-Type":"application/json"}});case 7:return r=e.sent,e.next=10,r.json();case 10:if(n=e.sent,r.ok){e.next=13;break}throw new Error(n.error.message);case 13:return e.next=15,u("/api/users/team");case 15:l({status:"success",title:"Team "+n.name+" successfully created",isClosable:!0}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),s=e.t0,(null!=(a=Error)&&"undefined"!==typeof Symbol&&a[Symbol.hasInstance]?a[Symbol.hasInstance](s):s instanceof a)?l({status:"error",title:"Error creating team",description:e.t0.message,isClosable:!0}):l({status:"error",title:"Error creating team",isClosable:!0});case 21:case"end":return e.stop()}var s,a}),e,null,[[4,18]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){z(a,n,s,i,o,"next",e)}function o(e){z(a,n,s,i,o,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.X6,{as:"h3",size:"md",pb:6,children:"You're not in any team currently."}),(0,n.jsx)(v.zx,{onClick:a,variant:"theme",children:"Click here to create a team"}),(0,n.jsx)(s.X6,{as:"h3",size:"md",pb:6,pt:8,children:"Pending team requests"}),(0,n.jsx)(_,{}),(0,n.jsxs)(b.u_,{isOpen:r,onClose:i,children:[(0,n.jsx)(b.ZA,{}),(0,n.jsxs)(b.hz,{bg:"theme.300",children:[(0,n.jsx)(b.xB,{children:"Create Team"}),(0,n.jsx)(b.ol,{}),(0,n.jsxs)("form",{onSubmit:f,children:[(0,n.jsx)(b.fe,{children:(0,n.jsx)(j.II,{ref:c,placeholder:"Enter your team's name"})}),(0,n.jsxs)(b.mz,{children:[(0,n.jsx)(v.zx,{variant:"theme",onClick:i,mr:3,children:"Close"}),(0,n.jsx)(v.zx,{variant:"theme",type:"submit",children:"Submit"})]})]})]})]})]})},A=r(31),N=function(){var e=(0,m.ZP)("/api/users/team"),t=e.data;return e.isValidating?(0,n.jsx)(f.Z,{}):t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.kC,{children:[(0,n.jsxs)(s.xu,{children:[(0,n.jsx)(s.X6,{as:"h2",size:"lg",display:"inline",children:"Team Name"}),(0,n.jsx)(s.xv,{fontSize:"xl",children:t.name})]}),(0,n.jsx)(u.u,{label:"Your team has "+(t.verified?"":"not")+" been verified",placement:"bottom",children:(0,n.jsx)("span",{style:{height:"24px"},children:(0,n.jsx)(c.JO,{as:t.verified?l.ZSR:l.lUB,color:t.verified?"green.500":"red.500",ml:2,height:"24px",width:"24px"})})})]}),(0,n.jsxs)(s.Kq,{pt:6,children:[(0,n.jsx)(s.X6,{as:"h3",size:"md",display:"inline",children:"Total Points"}),(0,n.jsx)(s.xv,{fontSize:"xl",children:t.points})]}),(0,n.jsxs)(s.Kq,{py:6,children:[(0,n.jsx)(s.X6,{size:"md",as:"h3",children:"Members (min 2, max 4)"}),(0,n.jsx)(s.aV,{spacing:3,children:t.users.map((function(e,t){return(0,n.jsx)(A.Z,{user:e},t+"."+e.email)}))}),(0,n.jsx)(s.X6,{size:"md",as:"h3",pt:6,children:(0,n.jsx)(u.u,{label:"Any requests sent by your team members will be shown here",children:"Sent team requests"})}),t.teamRequests.length&&(0,n.jsx)(s.aV,{children:t.teamRequests.map((function(e,t){return(0,n.jsx)(A.Z,{user:e.requestee,request:e},t+"."+e.requestee.email)}))})]}),(0,n.jsxs)(s.kC,{direction:"row-reverse",children:[(0,n.jsx)(q,{teamId:t.id}),(0,n.jsx)(C,{teamId:t.id,mr:4})]})]}):(0,n.jsx)(R,{})},X=function(){return(0,n.jsx)(s.xu,{p:8,pt:12,bg:"gray.800",rounded:"md",flexDirection:"column",maxW:"80%",m:"0 auto",width:"100%",children:(0,n.jsx)(N,{})})},Z=function(){var e,t=(0,a.useSession)(),r=t.data,u=t.status,c=(0,i.useRouter)();if((0,o.useEffect)((function(){"unauthenticated"===u&&c.push("/")}),[u]),"authenticated"===u)return(0,n.jsxs)(s.M5,{as:"main",bg:"black",py:12,flexDir:"column",children:[(0,n.jsx)(s.X6,{pb:10,as:"h1",children:"Welcome back, "+(null===r||void 0===r||null===(e=r.user)||void 0===e?void 0:e.name)+"!"}),(0,n.jsx)(X,{})]})}}},function(e){e.O(0,[228,690,625,774,888,179],(function(){return t=2115,e(e.s=t);var t}));var t=e.O();_N_E=t}]);