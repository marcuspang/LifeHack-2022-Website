(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[661],{7609:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/teams/[id]",function(){return r(4796)}])},2574:function(e,t,r){"use strict";var n;r.d(t,{X:function(){return n}}),function(e){e.DEFUALT="Please try again. If the error persists, contact us at xxx@gmail.com",e.ONE_EMAIL_ONLY="Your email address is linked with another provider, please login with that provider. If the error persists, please contact us at xxx@gmail.com"}(n||(n={}))},965:function(e,t,r){"use strict";var n=r(5893),s=r(8527),a=r(9609);r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){i(e,t,r[t])}))}return e}t.Z=function(e){return(0,n.jsx)(s.M5,{children:(0,n.jsx)(a.$,o({},e))})}},31:function(e,t,r){"use strict";var n=r(4051),s=r.n(n),a=r(5893),i=r(9876),o=r(5074),u=r(8527),c=r(5193),l=r(6541),d=r(385),f=r(5434),m=r(8100),h=r(2574);function p(e,t,r,n,s,a,i){try{var o=e[a](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,s)}t.Z=function(e){var t=e.user,r=e.request,n=(0,o.pm)(),x=(0,m.kY)().mutate,b=function(){var e,t=(e=s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=3;break}return n({status:"error",title:"Invalid delete reqeust",isClosable:!0}),e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch("/api/team-requests/"+r.id,{method:"DELETE"});case 6:return e.next=8,x("/api/users/team");case 8:n({status:"success",title:"Successfully removed team request",isClosable:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),n({status:"error",title:"Error deleting team request",description:h.X.DEFUALT,isClosable:!0});case 14:case"end":return e.stop()}}),e,null,[[3,11]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){p(a,n,s,i,o,"next",e)}function o(e){p(a,n,s,i,o,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();if(r){if(r.approved===d.Response.ACCEPTED)return null;var v=void 0,j="gray.500";switch(r.approved){case"NOT_RESPONDED":v=f.FmG;break;case"REJECTED":v=f.lUB,j="red.500"}return(0,a.jsxs)(u.HC,{children:[(0,a.jsx)(u.DE,{as:v,color:j,height:"22px"}),t.name," (",t.email,")",(0,a.jsx)(c.hU,{ml:3,"aria-label":"Cancel team request",icon:(0,a.jsx)(i.Tw,{}),bg:"transparent",_hover:{bg:"gray.600"},onClick:b})]},t.email)}return(0,a.jsx)(l.u,{label:t.name+" has earned "+t.points+" points",placement:"auto-start",children:(0,a.jsxs)(u.HC,{width:"auto",children:[(0,a.jsx)(u.DE,{as:f.ZSR,color:"green.500",height:"22px"}),t.name," (",t.email,")"]},t.email)})}},4796:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return z}});var n=r(5893),s=r(8527),a=r(385),i=r(3299),o=r(1163),u=r(7294),c=r(6541),l=r(894),d=r(5434),f=r(8100),m=r(965),h=r(4051),p=r.n(h),x=r(7375),b=r(5074),v=r(5193),j=r(6658),y=r(4612);function g(e,t,r,n,s,a,i){try{var o=e[a](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,s)}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){O(e,t,r[t])}))}return e}function E(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var k=function(e){var t=e.teamId,r=E(e,["teamId"]),s=(0,x.qY)(),a=s.isOpen,i=s.onOpen,o=s.onClose,c=(0,f.kY)().mutate,l=(0,u.useRef)(null),d=(0,b.pm)(),m=function(){var e,r=(e=p().mark((function e(r){var n,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),l.current&&l.current.value){e.next=4;break}return d({status:"error",title:"Please enter a valid email"}),e.abrupt("return");case 4:return e.prev=4,e.next=7,fetch("/api/teams/"+t+"/add-member",{method:"POST",body:JSON.stringify({email:l.current.value})});case 7:return n=e.sent,e.next=10,n.json();case 10:if(s=e.sent,n.ok){e.next=13;break}throw new Error(s.error.message);case 13:return e.next=15,c("/api/teams/"+t);case 15:d({status:"success",title:"Successfully added",isClosable:!0}),o(),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),a=e.t0,(null!=(i=Error)&&"undefined"!==typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](a):a instanceof i)?d({status:"error",title:"Error adding member",description:e.t0.message,isClosable:!0}):d({status:"error",title:"Error adding member",isClosable:!0});case 22:case"end":return e.stop()}var a,i}),e,null,[[4,19]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){g(a,n,s,i,o,"next",e)}function o(e){g(a,n,s,i,o,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.zx,w({variant:"theme",onClick:i},r,{children:"Add member"})),(0,n.jsxs)(j.u_,{isOpen:a,onClose:o,children:[(0,n.jsx)(j.ZA,{}),(0,n.jsxs)(j.hz,{bg:"theme.300",children:[(0,n.jsx)(j.xB,{children:"Add member"}),(0,n.jsx)(j.ol,{}),(0,n.jsxs)("form",{onSubmit:m,children:[(0,n.jsx)(j.fe,{children:(0,n.jsx)(y.II,{ref:l,type:"email",placeholder:"Enter a valid email"})}),(0,n.jsxs)(j.mz,{children:[(0,n.jsx)(v.zx,{variant:"theme",onClick:o,mr:3,children:"Close"}),(0,n.jsx)(v.zx,{variant:"theme",type:"submit",children:"Submit"})]})]})]})]})]})},P=r(2574);function S(e,t,r,n,s,a,i){try{var o=e[a](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,s)}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var D=function(e){var t=e.teamId,r=I(e,["teamId"]),s=(0,b.pm)(),a=(0,o.useRouter)(),i=function(){var e,r=(e=p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),!t){e.next=12;break}return e.prev=2,e.next=5,fetch("/api/teams/"+t,{method:"DELETE"});case 5:a.back(),s({status:"success",title:"Team successfully deleted",isClosable:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),s({status:"error",title:"Error leaving team",description:P.X.DEFUALT,isClosable:!0});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var a=e.apply(t,r);function i(e){S(a,n,s,i,o,"next",e)}function o(e){S(a,n,s,i,o,"throw",e)}i(void 0)}))});return function(){return r.apply(this,arguments)}}();return(0,n.jsx)(v.zx,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){C(e,t,r[t])}))}return e}({variant:"theme",onClick:i},r,{children:"Delete team"}))},q=r(31),_=function(e){var t=e.teamId,r=(0,f.ZP)("/api/teams/"+t),a=r.data;return r.isValidating?(0,n.jsx)(m.Z,{}):a&&t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.kC,{children:[(0,n.jsxs)(s.xu,{children:[(0,n.jsx)(s.X6,{as:"h2",size:"lg",display:"inline",children:"Team Name"}),(0,n.jsx)(s.xv,{fontSize:"xl",children:a.name})]}),(0,n.jsx)(c.u,{label:"Your team has "+(a.verified?"":"not")+" been verified",placement:"bottom",children:(0,n.jsxs)("span",{style:{height:"24px"},children:[(0,n.jsx)(l.JO,{as:a.verified?d.ZSR:d.lUB,color:a.verified?"green.500":"red.500",ml:2,height:"24px",width:"24px"})," "]})})]}),(0,n.jsxs)(s.Kq,{pt:6,children:[(0,n.jsx)(s.X6,{as:"h3",size:"md",display:"inline",children:"Total Points"}),(0,n.jsx)(s.xv,{fontSize:"xl",children:a.points})]}),(0,n.jsxs)(s.Kq,{py:6,children:[(0,n.jsx)(s.X6,{size:"md",as:"h3",children:"Members (min 2, max 4)"}),(0,n.jsx)(s.aV,{spacing:3,children:a.users.map((function(e,t){return(0,n.jsx)(q.Z,{user:e},t+"."+e.email)}))}),(0,n.jsx)(s.X6,{size:"md",as:"h3",pt:6,children:(0,n.jsx)(c.u,{label:"Any requests sent by your team members will be shown here",children:"Sent team requests"})}),a.teamRequests.length&&(0,n.jsx)(s.aV,{spacing:3,children:a.teamRequests.map((function(e,t){return(0,n.jsx)(q.Z,{user:e.requestee,request:e},t+"."+e.requestee.email)}))})]}),(0,n.jsxs)(s.kC,{direction:"row-reverse",children:[(0,n.jsx)(D,{teamId:t}),(0,n.jsx)(k,{teamId:t,mr:4})]})]}):(0,n.jsx)(s.X6,{as:"h2",size:"lg",children:"No such team"})},T=function(e){var t=e.teamId;return t?(0,n.jsx)(_,{teamId:t}):(0,n.jsx)(s.X6,{as:"h2",size:"lg",children:"Enter a valid teamId"})},z=function(){var e=(0,i.useSession)(),t=e.data,r=e.status,c=(0,o.useRouter)(),l=c.query.id;return(0,u.useEffect)((function(){"authenticated"===r&&t.user.role!==a.Role.ADMIN&&c.push("/"),"unauthenticated"===r&&c.push("/")}),[r]),(0,n.jsx)(s.M5,{as:"main",bg:"black",py:12,flexDir:"column",children:(0,n.jsx)(s.xu,{p:8,pt:12,bg:"gray.800",rounded:"md",flexDirection:"column",maxW:"80%",m:"0 auto",width:"100%",children:(0,n.jsx)(T,{teamId:null===l||void 0===l?void 0:l.toString()})})})}}},function(e){e.O(0,[228,690,625,774,888,179],(function(){return t=7609,e(e.s=t);var t}));var t=e.O();_N_E=t}]);